<!-- Header -->
<div style="background:white; border-bottom:1px solid #ddd; padding:1rem; position:sticky; top:0; z-index:100;">
	<div style="max-width:800px; margin:0 auto; display:flex; justify-content:space-between; align-items:center;">
		<h1 style="margin:0; color:#333; font-size:24px; font-weight:600;">ðŸ’– People Who Liked You</h1>
		<div style="color:#666; font-size:14px;">
			{{ totalElements() }} likes
		</div>
	</div>
</div>

<!-- Loading State (first load) -->
<div *ngIf="isLoading() && likedByUsers().length === 0"
	style="max-width:800px; margin:2rem auto; padding:2rem; text-align:center;">
	<div style="color:#666; font-size:18px;">Loading users who liked you...</div>
</div>

<!-- No Likes -->
<div *ngIf="!isLoading() && likedByUsers().length === 0"
	style="max-width:800px; margin:4rem auto; padding:2rem; text-align:center;">
	<div style="color:#666; font-size:18px; margin-bottom:1rem;">ðŸ’”</div>
	<div style="color:#333; font-size:20px; font-weight:600; margin-bottom:0.5rem;">No likes yet</div>
	<div style="color:#666; font-size:16px;">When someone likes your profile, they'll appear here!</div>
</div>

<!-- Liked By Users Grid -->
<div *ngIf="likedByUsers().length > 0" style="max-width:800px; margin:2rem auto; padding:0 1rem;">
	<div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:1.5rem;">

		<!-- User Card -->
		<div *ngFor="let user of likedByUsers()" (click)="viewProfile(user.username)"
			style="background:white; border:1px solid #ddd; border-radius:16px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.1); transition:transform 0.2s, box-shadow 0.2s; cursor:pointer; position:relative;"
			onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 24px rgba(0,0,0,0.15)'"
			onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)'"
			title="Click to view profile details">

			<!-- Like Badge -->
			<div
				style="position:absolute; top:10px; right:10px; background:rgba(255,20,147,0.9); color:white; padding:6px 12px; border-radius:20px; font-size:14px; font-weight:600; z-index:10; backdrop-filter:blur(5px);">
				ðŸ’– LIKED
			</div>

			<!-- Image Carousel -->
			<div style="position:relative; height:300px; overflow:hidden;">
				<!-- Main Image -->
				<img [src]="getCurrentImageUrl(user) || '/uploads/default-avatar.png'" [alt]="user.username + ' photo'"
					style="width:100%; height:100%; object-fit:cover;"
					onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">

				<!-- Navigation Arrows (only show if multiple images) -->
				<div *ngIf="getUserImages(user).length > 1">
					<!-- Left Arrow -->
					<button (click)="previousImage(user.username); $event.stopPropagation()"
						style="position:absolute; left:10px; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.5); color:white; border:none; border-radius:50%; width:40px; height:40px; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:18px; transition:background 0.2s;"
						onmouseover="this.style.background='rgba(0,0,0,0.7)'"
						onmouseout="this.style.background='rgba(0,0,0,0.5)'">
						&#8249;
					</button>
<!-- Right Arrow -->
<button (click)="nextImage(user.username); $event.stopPropagation()"
	style="position:absolute; right:10px; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.5); color:white; border:none; border-radius:50%; width:40px; height:40px; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:18px; transition:background 0.2s;"
	onmouseover="this.style.background='rgba(0,0,0,0.7)'" onmouseout="this.style.background='rgba(0,0,0,0.5)'">
	&#8250;
</button>
<!-- Image Indicators -->
<div style="position:absolute; bottom:10px; left:50%; transform:translateX(-50%); display:flex; gap:6px;">
	<div *ngFor="let image of getUserImages(user); let i = index"
		style="width:8px; height:8px; border-radius:50%; transition:background 0.2s; cursor:pointer;"
		[style.background]="(currentImageIndexes()[user.username] || 0) === i ? 'white' : 'rgba(255,255,255,0.5)'"
		(click)="setImageIndex(user.username, i); $event.stopPropagation()">
	</div>
</div>
</div>
			</div>

			<!-- User Info -->
			<div style="padding:1rem;">
				<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
					<h3 style="margin:0; color:#333; font-size:18px; font-weight:600;">{{ user.username }}</h3>
					<div style="color:#666; font-size:14px;">{{ calculateAge(user.dateOfBirth) }} years</div>
				</div>
			</div>
			</div>
			</div>
			</div>
			
			<!-- Loading More -->
			<div *ngIf="isLoadingMore()" style="max-width:800px; margin:2rem auto; padding:1rem; text-align:center;">
				<div style="color:#666; font-size:16px;">Loading more users...</div>
			</div>
			
			<!-- End of List -->
			<div *ngIf="last() && likedByUsers().length > 0"
				style="max-width:800px; margin:2rem auto; padding:1rem; text-align:center;">
				<div style="color:#666; font-size:16px;">You've seen all your liked-by users!</div>
			</div>
			
			<!-- User Detail Modal -->
			<div *ngIf="showUserDetail()"
				style="position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:1000; padding:1rem;">
			
				<div
					style="background:white; border-radius:16px; max-width:600px; width:100%; max-height:90vh; overflow-y:auto; position:relative;">
					<!-- Close Button -->
					<button (click)="closeUserDetailModal()"
						style="position:absolute; top:1rem; right:1rem; background:none; border:none; font-size:24px; cursor:pointer; color:#666; z-index:10;">
						Ã—
					</button>

		<!-- Loading State -->
		<div *ngIf="loadingUserDetail()" style="padding:2rem; text-align:center;">
			<div style="color:#666; font-size:18px;">Loading user details...</div>
		</div>

		<!-- User Detail Content -->
		<div *ngIf="!loadingUserDetail() && userDetail()">
			<!-- Profile Image -->
			<div style="height:300px; overflow:hidden; border-radius:16px 16px 0 0;">
				<img [src]="convertImagePath(userDetail()!.profileImageUrl) || '/uploads/default-avatar.png'"
					[alt]="userDetail()!.username + ' profile'" style="width:100%; height:100%; object-fit:cover;"
					onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">
			</div>

			<!-- User Info -->
			<div style="padding:2rem;">
				<!-- Basic Info -->
				<div style="margin-bottom:2rem;">
					<h2 style="margin:0 0 0.5rem 0; color:#333; font-size:28px; font-weight:600;">
						{{ userDetail()!.firstName }} {{ userDetail()!.lastName }}
					</h2>
					<div style="color:#666; font-size:18px; margin-bottom:1rem;">@{{ userDetail()!.username }}</div>
					<div style="color:#666; font-size:16px;">{{ calculateAge(userDetail()!.dateOfBirth) }} years old</div>
				</div>

				<!-- Stats -->
				<div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(120px, 1fr)); gap:1rem; margin-bottom:2rem;">
					<div style="text-align:center; padding:1rem; background:#f8f9fa; border-radius:12px;">
						<div style="font-size:24px; font-weight:600; color:#333;">{{ userDetail()!.fame }}</div>
						<div style="font-size:14px; color:#666;">Fame Rating</div>
					</div>
					<div style="text-align:center; padding:1rem; background:#f8f9fa; border-radius:12px;">
						<div style="font-size:24px; font-weight:600; color:#333;">{{ userDetail()!.distance }}km</div>
						<div style="font-size:14px; color:#666;">Distance</div>
					</div>
					<div style="text-align:center; padding:1rem; background:#f8f9fa; border-radius:12px;">
						<div style="font-size:14px; font-weight:600; color:#333;">{{ formatLastOnline(userDetail()!.lastOnline) }}</div>
						<div style="font-size:14px; color:#666;">Last Online</div>
					</div>
					</div>

				<!-- Biography -->
				<div *ngIf="userDetail()!.biography" style="margin-bottom:2rem;">
					<h3 style="margin:0 0 1rem 0; color:#333; font-size:18px; font-weight:600;">About</h3>
					<p style="margin:0; color:#666; font-size:16px; line-height:1.5;">{{ userDetail()!.biography }}</p>
				</div>

				<!-- Interests -->
				<div *ngIf="userDetail()!.interests && userDetail()!.interests.length > 0" style="margin-bottom:2rem;">
					<h3 style="margin:0 0 1rem 0; color:#333; font-size:18px; font-weight:600;">Interests</h3>
					<div style="display:flex; flex-wrap:wrap; gap:0.5rem;">
						<span *ngFor="let interest of userDetail()!.interests"
							style="background:#e3f2fd; color:#1976d2; padding:0.5rem 1rem; border-radius:20px; font-size:14px; font-weight:500;">
							{{ interest }}
						</span>
					</div>
				</div>
			</div>
			</div>
			</div>
</div>